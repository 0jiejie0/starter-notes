# 数据库锁

应用软件锁另见：[Java锁](../../../软件开发/原理探析/Java锁.MD)。
对于一次的数据修改，我们可以大概将其分为三步：

* 获取数据
* 修改数据
* 提交修改

这里假设有A、B两个角色修改数据。

## 乐观锁

对数据改动持乐观态度：认为在查询到修改的过程中，大概不会有其他人来修改数据。

### 实现方式
* 引入版本

给数据表添加一个version字段，每次修改提交后，版本号递增。

如A在获取数据时，数据版本是v2，那提交时执行的语句就是：
```sql
update a_table set a_column = '*' , where version = v2
```

如果在中途，B修改了数据，那数据库对应数据就会变成v3，A对v2的修改就失效了，不会产生异常。

## 悲观锁

对数据改动持悲观态度，认为在查询修改提交期间，极有可能会有人来修改数据。

A在获取数据后，就对数据加锁，提交修改后释放。途中由于加锁，B读取时会阻塞B，读不了数据，所以数据不会被修改。 

### 实现方式

#### 排它锁

#### 共享锁

### 优缺点
