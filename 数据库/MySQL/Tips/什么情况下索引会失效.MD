# 什么情况下索引会失效？

## 违反最左前缀法则

    给出本文部分名词定义：
    索引列，定义某索引时，使用到的列，定义中的先后顺序决定各列优先级，最先写的列，优先级最高，使用索引时最先使用该列的条件筛选；
    最左前缀，索引使用到name、age、height、weight四列，name age height是最左前缀，name是最左前缀，name age weight不是，而name age是；

在某索引使用多列的情况下，要**正确**使用该索引的话：

1. 要按照索引列的最左前缀方案添加where条件；
2. 各where条件按照索引列的最左前缀生效，不完全是最左前缀的（开头满足最左前缀，中间某索引列跳过，后续又出现部分索引列的情况）开头满足最左前缀的部分走索引，后续序列失效；

若查询条件不包含第一个索引列，则索引不生效。

## 范围查询

范围查询字段其右的列，不会走索引。

## 索引列上的运算操作

例如某表以name字段建立了索引，在查询时，在 where 中使用 substring 截取该字段。
例：`select * from t where substring(name,2,2)='aa'`；
而推测 `select * from t where substring('aaaaaa',2,2)=name` 是会生效索引的，注意区分。

## 字符串不加单引号，可能使得字符串字段产生类型转换，导致索引失效

## 模糊查询可能会导致索引失效

以%开头的Like模糊查询，导致索引失效；

如果仅在尾部使用%模糊匹配，则索引不会失效。
