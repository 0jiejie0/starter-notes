# 背景

为了保证在线笔记的安全性，最近找到了一种利用gitee的仓库镜像管理功能，（每次更新时）自动从gitee向github同步的方法。由于github访问越来越慢，有时甚至不能访问，所以采用```本地```-①->```gitee```-②->```github```的方案。gitee官方有国际专线，所以第二个环节不用担心，即时同步实测可行。

在[gitee官方文档](https://help.gitee.com/repository/settings/sync-between-gitee-github)中其实有这方面介绍，常见问题也有对应预案，不巧的是我不太会扯名词，搜不到，搜到的内容大致有二：1、github -》 gitee，2、本地配置双远程库，每次更新推送两次，不符合我的要求；还对着webhook研究了半天没搞明白，大费周章才找到它，特此简要记录下来。需要注意的是本功能只是限时开放，不知道后续会不会收费。

# Push：Gitee->GitHub，gitee仓库镜像到github

> 配置此镜像后，当你提交代码到 Gitee 的仓库时，Gitee 会自动向 GitHub 同步仓库。

1. 打开需要自动同步的仓库，点击```管理```》```仓库镜像管理```》```添加镜像```；
2. 申请github私人令牌，在绑定github账号的用户设置中，点击最下方「```Developer setting```」，选择「```Personal access tokens```」选项后点击「```token （classic）```(大概是这么写的我记不清了，文档和github官网有出入)」，点击右上方生成按钮，选择第二项classic，随便写个note标记，把```select scopes```都选上（删库别选），最后点击生成按钮，点击页面中长串字符后的剪贴板按钮，复制令牌；
3. 选择 Push 方向，在「镜像仓库」下拉列表中选择需要镜像的仓库（这里可能会导致无法操作，需要手动在github上先导入本项目，然后刷新本页面即可正常操作），在个人令牌中输入刚刚复制的github令牌；
4. 点击添加按钮保存配置；

提交代码和手动更新都可以触发镜像操作

# Pull：GitHub->Gitee

1. 打开需要同步的仓库，经过上一节，本步跳过；
2. 添加镜像，选择Pull方向，在「镜像仓库」下拉列表中选择需要镜像的仓库，在「个人令牌」中输入刚刚复制的 GitHub 私人令牌
3. 根据实际情况决定是否需要勾选「自动从 GitHub 同步仓库」；
4. 点击添加按钮保存配置；

推送代码到github和手动更新都可以触发本镜像操作

# 双向镜像（同时配置Push和Pull，有代码丢失风险）

依次执行上述两项配置即可。

为防止代码丢失，尽量避免一边提交gitee一边提交github，所有改动都提交到gitee即可，在国内也更稳定。

其实远程库代码丢失问题也不大，因为本地库有记录，随时可以新建。
