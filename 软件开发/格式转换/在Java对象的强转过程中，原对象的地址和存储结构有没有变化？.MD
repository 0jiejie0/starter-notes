# 在Java对象（复杂类型）的强转过程中，原对象的地址和存储结构有没有变化？

## 背景

原本好些天前我询问ai助手得知，会发生变化，因为在一次强制转换过程中（复杂类型），因为类型变了，所以对象在内存中的存储结构势必会发生变化（好像不一定？）。
然而今天在调试过程中发现，改变一个map中的list强转出的对象，向其中加入数据，map中的list竟然也会同步修改。

## 分析

仔细想一下，什么情况下Java会允许强制转换？

1. 某祖先类引用对象，对象的class属性和目标类型一致的时候，不管是用Object还是某个父类指针引用对象，判定类型一致即可转化，此时无需改变内存结构；
2. 某祖先类引用对象，对象的class属性是目标类型的子类（我猜可以），这个对象本质上符合目标类型的存储结构（子类继承父类，当然兼容父类），也无需改变内存结构。

那，强转一定不会改变对象的内存结构吗？

讨论一种异常情况，如果对象的class属性不是目标类型的时候，强转会报异常。

这就说明，类型兼容jdk才会转换，对象的内存结构没有改变的必要，也就是说，强转仅仅是改变了指针的引用类型，原对象的地址和存储结构没有变化。

debug验证一下，强转一条请求数据为String类型，打断点查看，发现原map中String的char数组地址和强转后的变量char数组一样，说明确实没有变化。
（仅测试String，未对其他对象作进一步测试）
