## Java开发环节

### Java特殊字符转义

#### 反斜杠\的正则匹配

有时将几个数据组合成一个字符串存储，数据间利用反斜杠进行分隔。在这种情况下，取数据就需要斟酌一番。

由于Java和正则各自都是用\\表示真实数据里的一个\，在Java中的正则就是套了两层这个规则，所以需要用 `\\\\`
（四个反斜杠表示实际数据中的一个\）分割字符串。

#### 双引号"

如果在字符串中使用双引号作分隔符，双引号在Java中有特殊含义表示字符串的开始和结束，在正则表达式中却没有特殊含义。

因此，在Java使用正则分隔数据时，要用 `\"` 分割字符串。

#### 其他正则中的特殊符号`$`、`^`、`*`、`+`、`(`、`)`、`[`、`]`、`'`、`|`、`.`、`?`

这类特殊符合在Java中仅作为普通字符处理，但是在正则中需要用反斜杠转义。

而在Java中需要用\\表示真实数据里的一个\，所以需要用类似`\\.`、`\\$`、`\\^`分隔字符串。

### 字符串分割 split()方法

* 分隔符中的特殊字符，根据上小节内容进行转义后使用；
* 对元素数量固定的待分割数据，分割前在原数据后追加一个空格，然后再进行分割；
* [有关用例详细说明](./split字符串分割深度解析.MD#用例说明)

### 字符串替换

* replace方法，替换字符串中所有出现字符，对所有子串进行替换，**不支持正则匹配**
* replaceAll方法，**使用正则**匹配字符串中所有字符，对符合匹配条件的子串进行替换。

这两个方法都不会进行递归处理，例如`"abcdbcdbcd".replaceAll("abcd","a");`得到的是`"abcdbcd"`，而不是`"a"`。

#### 去除数字中混杂的大小写字母及空格

```java
Utils.getString(data).replaceAll("[a-z A-Z]","")
```

#### 去除数据集中 除数字和逗号分隔符以外 的字符

```java
Utils.getString(data).replaceAll("[^0-9,^\,]","")
```

### map数据类型转换

* 一般该场景下的值项是Object或String泛型，且不保证一定有值
* 获取到某键对应值后，先判null（可以利用[Java8 Optional](https://www.w3cschool.cn/java/java8-optional-class.html)），
  且字符串长度大于0（根据业务场景判定是否必要），确认有值再进行后续操作
* 类型转换前，针对Object要判别该对象class是否为预期类型（OneType.class.equals(value.getClass())）；针对String，校验其内容格式后，再转换
  （改进：value instanceof OneType ，代码上更为简洁，但要注意如果value为null，返回值是false）  

示例：

```java
Optional.ofNullable(map.get("anObject"))
        .ifPresent(obj->{
              if(!obj instanceof String)return;
              String s = obj.toString;
              // processing procedure
        });
```
或者利用Hutool的Convert类：
```java
        Convert.toStr(null); // null
        Convert.toStr(null,""); // "" 第二个参数表示数据为null时的默认值，其他类型转换默认值同理
        Convert.toStr(""); // ""
        Convert.toStr("abc"); // "abc"
```

## 测试环节

### 特殊字符

* % /（未全测）

在搜索查询时，前端输入%或/、\等，若后端没有针对特殊字符进行处理，会导致无法正常查询

* 空格

统计数据时，带有空格的数项由于输入框未做字符限定，无法成功转为数字，（前端）会跳过该项（实际上可以剔除其他字符，转换成一个数），导致计算结果错误
