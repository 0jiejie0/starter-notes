# 移动、联调宽带开启公网IPv6

    IPv4、IPv6、内网穿透、公网、光纤入户

## 背景

偶然看到一个声称不需要向日葵、todesk等远程桌面软件的视频，是利用公网暴露的IPv6。
正好我也有这个需要，起码多一个远程连接的备份。跟着做了，发现确实可行，不过并不十分顺利，特此将完整步骤记录下来，以备后用。

## 解决方案

### 1、路由器开启IPv6

小米路由器（密码在路由器底面）：

1. 192.168.10.1》常用设置》上网设置》IPv6网络设置
2. 打开IPv6开关
3. 上网方式：Native
4. 自动配置DNS
5. 点击应用

华为路由器（密码在路由器底面）：

1. cmcc.wifi》更多功能》网络设置》IPv6
2. 打开IPv6开关
3. 因特网： 地址类型 自动配置
   DNS 获取方式 自动配置
4. 局域网： 路由广播配置 自动配置
   DHCP 服务器 自动配置
5. 点击保存

### 2、本机IP查看

两种方法：

* 打开“网络和internet设置”》更改适配器选项》双击查看连接网络的适配器状态》连接》确认 **IPv6连接显示 internet**
  ，》点击详细信息》显示IPv6及临时地址
* win+r》cmd》输入`ipconfig`命令》找到连网适配器》查看有无IPv6地址

### 3、IPv6网址检测确认

两种方法：

* 搜索“IPv6 地址查询”，找到 [https://ipw.cn/ipv6/](https://ipw.cn/ipv6/)，如配置成功，可以看到页面的提示
* 打开 powershell 或者 gitbash （二者结果有所不同），执行`curl test.ipw.cn`，也可以显示本机的IPv6地址

好像IPv6地址有多个，哪个都行？

执行到现在，电脑已经拥有IPv6地址了，但是只能用来上网，公网现在是不能连接本地电脑的。
**如果确实需要从外部连接**我们的电脑，需要下面的第四、五步：

### 4、调整光猫防火墙设置（被控被访问端）

联通（用户名和密码在光猫底面）：

1. 打开 http://192.168.1.1/
2. 输入用户密码，登录（可能会显示 400 Bad Reuqest Your request has bad syntax or is inherently impossible to satisfy.
   错误，可能是由于浏览器记住密码导致，输入一个空格然后删除空格，再次操作即可成功）
3. 打开 状态》网络侧信息》IPv6连接信息，确认显示IPv6地址
4. 打开 安全》防火墙》安全级，调为低
5. 打开 安全》防火墙》攻击保护设置
6. （下面的选项可能只需要去掉Ipv6Spi的勾就可以，以防万一我把可行的整套方案记录下来，以排后患）
7. 防攻击保护√ 可勾选
8. 防端口扫描 不勾选
9. Ipv4Spi√ 可勾选
10. **Ipv6Spi× 不勾选**
11. 点击确定按钮

移动（密码在光猫底面）：

1. 打开 http://192.168.1.1/
2. 输入密码，点击箭头`→`登录
3. 点击 安全》防火墙
4. （下面的选项可能只需要去掉Ipv6Spi的勾就可以，以防万一我把可行的整套方案记录下来，以排后患）
5. 防DoS攻击√ 勾选
6. Ipv4spi√ 勾选
7. **Ipv6spi× 不勾选**
8. 防火墙等级(IPv4) 选择 低
9. 点击确定按钮

### 5、调整路由器防火墙设置（被控被访问端）

小米路由器：无需设置

华为路由器：

1. cmcc.wifi》更多功能》安全设置》防火墙
2. 点击开关关闭防火墙

## 友情提醒

在公网环境暴露任何电子设备均有被攻击甚至数据泄露风险，请时刻谨记安全上网。如非必要，请勿随意设定上文中的第4、5项配置。不用时建议打开防火墙。

# 免责声明

## 以上仅为笔者自用方案，非专业人士请勿擅自修改网络设备配置！

## 对 阅读本文内容而擅自设定网络设备造成的损失，笔者概不负责！
