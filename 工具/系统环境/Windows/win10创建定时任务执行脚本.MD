# 如何利用windows10系统的定时任务，定期执行脚本？

    win10、任务计划程序、task、定时任务、脚本

## 背景

    写了一个管理文件的脚本，但是需要经常运行，故问询ai，实测可行，以有本文。

## 解决方案

1. 打开任务计划程序
    * 搜索`任务计划程序`
    * 或 右键点击`此电脑`图标》`管理`，在打开的计算机管理窗口中找到`任务计划程序`，打开
2. 创建新任务
    1. 在任务计划程序窗口中，选择“创建任务”（部分版本可能需要点击“创建基本任务”后再进行更详细的设置）
    2. 在“常规”选项卡中，输入任务的名称和描述。如果希望任务以管理员权限运行，可以勾选“使用最高权限运行此任务”
3. 设置触发器
    1. 切换到“触发器”选项卡，然后选择“新建”以创建新的触发器
    2. 根据需要选择触发条件。例如，可以选择“每天”、“每周”、“每月”等，或者选择“每隔”并设置具体的间隔时间
    3. 选择开始任务的日期和时间
4. 设置操作
    1. 切换到“操作”选项卡，选择“新建”以创建新的操作
    2. 在操作设置中，选择“启动程序”作为操作类型
    3. 在“程序/脚本”字段中，输入要执行的脚本的路径。批处理文件（.bat）直接输入其路径；其他脚本（如Python）则要输入解释器（如python.exe）的路径和脚本的路径
5. 配置其他选项（可选）
    1. 在“条件”选项卡中配置任务触发的其他条件，如电源连接状态、网络状态等，注意这里勾选的条件，只要一个不满足就不会执行
    2. 在“设置”选项卡中，可以配置任务的执行时间限制、重试策略等
6. 点击“确定”保存任务设置。此时已经成功创建定时任务

## 可能遇到的问题及相应方案

### 任务计划执行结果显示0x7f

这是报错了，双击编辑任务，在常规选项卡中，下方有安全选项，将其运行任务使用的账户改为`SYSTEM`，
~~然后再把脚本最后加一行`exit /b 0`，但是这个好像没什么用~~

[参考文章](https://blog.csdn.net/qq_27496239/article/details/88726057)

### 任务计划显示执行成功0，但实际文件无任何影响，手动双击脚本发现脚本没有问题

推测，是脚本使用相对目录的问题，这个相对路径不是从脚本位置出发，而是从执行脚本的位置出发。

尝试将所有路径使用参数传递，...
